const DateTime=luxon.DateTime;function Follow(event,self,id){event.preventDefault();let type="1";let $control=jQuery(self);if($control.hasClass('following')){RemoveFollowing(id,type,self)}else{AddFollow(id,type,self)}}
function RenderEmptyFollows(){let html="";html+='<div class="no-follows-container">'
html+='   <div class="message">'
html+='       <h3 class="title mb-3">You are not following any events.</h3>'
html+='       <span class="description">Press "Follow" above game odds. Need help? <a href="#" class="following-tutorial-link" data-toggle="modal" data-target="#followinModalTutorial">Learn how to follow an event.</a></span>'
html+='   </div>'
html+='</div>'
jQuery('#follows').html(html)}
function RenderError(message){let html=`<div class="no-follows-container"><div class="message error"><h3 class="title mb-3">${message}</h3></div></div>`;jQuery('#follows').html(html)}
function RenderFollow(follow){function LeagueTitle(follow){return(`<div><div id="top-name-league"class="bg-alt-blue"><h3 id=""class="m-0 border-bottom border-white"><span id="">${follow.Sport}-${follow.League}</span></h3></div></div>`);}
function MatchDate(date){let formattedDate=DateTime.fromISO(date).toFormat('ccc, LLL dd, y');return(`<h4 class="sport-sort-controls m-0 border-bottom border-white"><span class="date font-weight-normal">${formattedDate}&nbsp;EST</span></h4>`);}
function Headers(){let spreadName="Point Spread"
switch(follow.Sport){case"Baseball":spreadName="Run Line"
break;case"Tennis":spreadName="Game Hcp"
break;case"Ice Hockey":spreadName="Puck Line"
break;case"Soccer":case"Martial Arts":spreadName="Handicap"
break;default:spreadName="Point Spread"}
return(`<div class="headers"><div class="header header-rot col-3 col-lg-1 d-none d-lg-block"><span>Rot</span></div><div class="header header-team col-3 col-lg-3 d-none d-lg-block"><span>Team</span></div><div class="header header-spread col-3 col-lg-2"><span>${spreadName}</span></div><div class="header header-money col-3 col-lg-2"><span>Moneyline</span></div><div class="header header-total col-3 col-lg-2"><span>Total</span></div><div class="header header-team-total col-3 col-lg-2"><span>Team Total</span></div></div>`)}
let html=`<div id="game-lines"><div class="game-block"style="margin-top: 20px;">${LeagueTitle(follow)}
${MatchDate(follow.Games[0].GameDateTime)}
${Headers()}
${follow.Games.map((game)=>RenderGame(game)).join('')}</div></div>`;jQuery('#follows').append(html)}
function RenderGame(game){function GameTime(dateTime){let formattedTime=DateTime.fromISO(dateTime).toFormat('h:mma').slice(0,-1).toLowerCase();return(`<div class="row live bg-light-gray border-bottom border-top border-white"style="font-size: 0.8rem;"><div class="d-flex align-items-center"><div class="p-1 pl-3 gamelines-info-row"><span class="time"><i class="far fa-clock"></i><span>${formattedTime}</span></span></div></div><div class="d-flex align-items-center">${game.MatchupLink!=null&&game.MatchupLink!=""?(`<div class="p-1"><a href="${game.MatchupLink}"class="link-matchup"title="View Matchup Information"onclick="popWindow(href,'Matchups',800,600); return false;"target="Matchups"><div class="matchup-icon"></div></a></div>`):(``)}<div class="p-1"><div class="game-action-container"><a id="lnkFollow"class="link-follow following"href="#"data-id="${game.GameNumber}"onclick="Follow(event, this, '${game.GameNumber}')">Following</a></div></div><div class="p-1"><a class="link-markets"href="${game.Url}"title="View markets for this game">Markets(+${game.MarketsCount})<i class="fas fa-angle-right"></i></a></div></div></div>`)}
function AwayTeam(team,lines){return(`<div class="col-12 visitor p-0 order-lg-1"><div class="container-fluid"><div class="row d-lg-none"><div class="rot col-2">${team.Rotation}</div><div class="team t-desc col-10">${team.Name}
${team.Pitcher!=null?(`<span id="divPitcherVisitor"class="pitcher pl-2">${team.Pitcher}</span>`):(``)}</div></div><div class="row visitor-lines bg-white"><div class="away-rotation g-ln col-3 p-1 col-lg-1 d-none d-lg-flex">${team.Rotation}</div><div id="awayTeamContainer"class="g-ln col-3 p-1 col-lg-3 border-left-0 text-left d-none d-lg-flex"><span id="awayName">${team.Name}</span>${team.Pitcher!=null?(`<span id="awayPitcher"class="pitcher">${team.Pitcher}</span>`):(``)}</div><div class="g-ln col-3 col-lg-2 p-0 border-left-0 line-container">${lines.Spread!=null?(`<a href="#"class="bet-link ${lines.Spread.Away.FavoriteMoveDirection == "Up" ? 'line-move-up' : lines.Spread.Away.FavoriteMoveDirection == "Down" ? 'line-move-down' : ''}"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '0', '0', null, '${lines.Spread.Away.Price}', '${lines.Spread.Away.Decimal}', '${lines.Spread.Away.Numerator}', '${lines.Spread.Away.Denominator}', '${lines.Spread.Away.Points}', '${lines.Spread.Away.Quarter}', '${lines.Spread.Home.Price}')">${lines.Spread.Away.Odds}</a>`):(``)}</div><div class="g-ln col-3 p-0 col-lg-2 line-container border-bottom-0">${lines.MoneyLine!=null?(`<a href="#"class="bet-link ${lines.MoneyLine.Away.FavoriteMoveDirection == "Up" ? 'line-move-up' : lines.MoneyLine.Away.FavoriteMoveDirection == "Down" ? 'line-move-down' : ''}"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '1', '0', null, '${lines.MoneyLine.Away.Price}', '${lines.MoneyLine.Away.Decimal}', '${lines.MoneyLine.Away.Numerator}', '${lines.MoneyLine.Away.Denominator}', 'null', 'null', '${lines.MoneyLine.Home.Price}')">${lines.MoneyLine.Away.Odds}</a>`):(``)}</div><div class="g-ln col-3 col-lg-2 p-0 line-container">${lines.Total!=null?(`<a href="#"class="bet-link"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '3', '0', '0', '${lines.Total.Over.Over}', '${lines.Total.Over.OverDecimal}', '${lines.Total.Over.Numerator}', '${lines.Total.Over.Denominator}', '${lines.Total.Over.Points}', '${lines.Total.Over.Quarter}', '${lines.Total.Under.Under}')">${lines.Total.Over.Odds}
${lines.Total.Over.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.Total.Over.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a>`):(``)}</div><div class="g-ln col-3 col-lg-2 px-0 line-container-teamtotal">${lines.TeamTotal!=null?(`<a href="#"class="bet-link-teamtotal border-bottom border-light-gray"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '4', '0', '0', '${lines.TeamTotal.Away.Over.Over}', '${lines.TeamTotal.Away.Over.OverDecimal}', '${lines.TeamTotal.Away.Over.Numerator}', '${lines.TeamTotal.Away.Over.Denominator}', '${lines.TeamTotal.Away.Over.Points}', '${lines.TeamTotal.Away.Over.Quarter}', '${lines.TeamTotal.Away.Under.Under}')">${lines.TeamTotal.Away.Over.Odds}
${lines.TeamTotal.Away.Over.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.TeamTotal.Away.Over.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a><a href="#"class="bet-link-teamtotal border-bottom border-light-gray"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '4', '0', '1', '${lines.TeamTotal.Away.Under.Under}', '${lines.TeamTotal.Away.Under.UnderDecimal}', '${lines.TeamTotal.Away.Under.Numerator}', '${lines.TeamTotal.Away.Under.Denominator}', '${lines.TeamTotal.Away.Under.Points}', '${lines.TeamTotal.Away.Under.Quarter}', '${lines.TeamTotal.Away.Over.Over}')">${lines.TeamTotal.Away.Under.Odds}
${lines.TeamTotal.Away.Under.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.TeamTotal.Away.Under.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a>`):(``)}</div></div></div></div>`)}
function HomeTeam(team,lines){return(`<div class="col-12 home p-0 order-lg-9"><div class="container-fluid"><div class="row d-lg-none"><div class="rot col-2">${team.Rotation}</div><div class="team t-desc col-10">${team.Name}
${team.Pitcher!=null?(`<span id="divPitcherVisitor"class="pitcher pl-2">${team.Pitcher}</span>`):(``)}</div></div><div class="row home-lines bg-white"><div class="home-rotation g-ln col-3 p-1 col-lg-1 d-none d-lg-flex border-bottom-0">${team.Rotation}</div><div id="homeTeamContainer"class="g-ln col-3 col-lg-3 p-1 text-left d-none d-lg-flex border-bottom-0"><span id="homeName">${team.Name}</span>${team.Pitcher!=null?(`<span id="homePitcher"class="pitcher">${team.Pitcher}</span>`):(``)}</div><div class="col-3 p-0 col-lg-2 line-container border-bottom-0">${lines.Spread!=null?(`<a href="#"class="bet-link ${lines.Spread.Home.FavoriteMoveDirection == "Up" ? 'line-move-up' : lines.Spread.Home.FavoriteMoveDirection == "Down" ? 'line-move-down' : ''}"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '0', '1', null, '${lines.Spread.Home.Price}', '${lines.Spread.Home.Decimal}', '${lines.Spread.Home.Numerator}', '${lines.Spread.Home.Denominator}', '${lines.Spread.Home.Points}', '${lines.Spread.Home.Quarter}', '${lines.Spread.Away.Price}')">${lines.Spread.Home.Odds}</a>`):(``)}</div><div class="g-ln col-3 p-0 col-lg-2 line-container border-bottom-0">${lines.MoneyLine!=null?(`<a href="#"class="bet-link ${lines.MoneyLine.Home.FavoriteMoveDirection == "Up" ? 'line-move-up' : lines.MoneyLine.Home.FavoriteMoveDirection == "Down" ? 'line-move-down' : ''}"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '1', '1', null, '${lines.MoneyLine.Home.Price}', '${lines.MoneyLine.Home.Decimal}', '${lines.MoneyLine.Home.Numerator}', '${lines.MoneyLine.Home.Denominator}', 'null', 'null', '${lines.MoneyLine.Away.Price}')">${lines.MoneyLine.Home.Odds}</a>`):(``)}</div><div class="g-ln col-3 p-0 col-lg-2 border-top-0 line-container border-bottom-0">${lines.Total!=null?(`<a href="#"class="bet-link"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '3', '1', '1', '${lines.Total.Under.Under}', '${lines.Total.Under.UnderDecimal}', '${lines.Total.Under.Numerator}', '${lines.Total.Under.Denominator}', '${lines.Total.Under.Points}', '${lines.Total.Under.Quarter}', '${lines.Total.Over.Over}')">${lines.Total.Under.Odds}
${lines.Total.Under.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.Total.Under.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a>`):(``)}</div><div class="g-ln col-3 col-lg-2 px-0 line-container-teamtotal">${lines.TeamTotal!=null?(`<a href="#"class="bet-link-teamtotal border-bottom border-light-gray"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '4', '1', '0', '${lines.TeamTotal.Home.Over.Over}', '${lines.TeamTotal.Home.Over.OverDecimal}', '${lines.TeamTotal.Home.Over.Numerator}', '${lines.TeamTotal.Home.Over.Denominator}', '${lines.TeamTotal.Home.Over.Points}', '${lines.TeamTotal.Home.Over.Quarter}', '${lines.TeamTotal.Home.Under.Under}')">${lines.TeamTotal.Home.Over.Odds}
${lines.TeamTotal.Home.Over.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.TeamTotal.Home.Over.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a><a href="#"class="bet-link-teamtotal border-bottom border-light-gray"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '4', '1', '1', '${lines.TeamTotal.Home.Under.Under}', '${lines.TeamTotal.Home.Under.UnderDecimal}', '${lines.TeamTotal.Home.Under.Numerator}', '${lines.TeamTotal.Home.Under.Denominator}', '${lines.TeamTotal.Home.Under.Points}', '${lines.TeamTotal.Home.Under.Quarter}', '${lines.TeamTotal.Home.Over.Over}')">${lines.TeamTotal.Home.Under.Odds}
${lines.TeamTotal.Home.Under.FavoriteMoveDirection=="Up"?(`<i class=" p-1 fas fa-sort-up"></i>`):lines.TeamTotal.Home.Under.FavoriteMoveDirection=="Down"?(`<i class=" p-1 fas fa-sort-down"></i>`):(``)}</a>`):(``)}</div></div></div></div>`)}
function Draw(lines){let price=lines.MoneyLine.Draw.Odds;return(`<div class="draw col-12 p-0 order-lg-9"id="tbrDraw"><div class="container-fluid"><div class="row d-lg-none"><div class="rot col-3"><div class="team">Draw</div></div></div><div class="row draw-lines bg-white"><div class="draw-rotation g-ln col-3 col-lg-1 p-1"><div class="rot"></div></div><div id="drawTeamContainer"class="g-ln col-3 col-lg-3 p-1 border-left-0 text-left d-none d-lg-flex">Draw</div><div class="g-ln col-3 p-1 col-lg-2 border-left-0 d-none d-lg-flex border-right border-light-gray"></div><div class="g-ln col-3 col-lg-2 p-0 border-left-0 line-container">${lines.Spread!=null?(`<a href="#"class="bet-link"onclick="AddBet(event, this, '${game.GameNumber}', '${lines.PeriodNumber}', '${lines.S}', '${lines.P}', '1', '2', null, '${lines.MoneyLine.Draw.Price}', '${lines.MoneyLine.Draw.Decimal}', '${lines.MoneyLine.Draw.Numerator}', '${lines.MoneyLine.Draw.Denominator}', 'null', 'null', 'null')">${price}</a>`):(``)}</div><div class="g-ln col-3 col-lg-2 p-1 border-left-0 border-right border-light-gray"></div><div class="g-lncol-3 col-lg-2 p-1 border-left-0 border-right border-light-gray"><div class="team-total">&nbsp;</div></div></div></div></div>`);}
return(`<div class="normal"data-game="${game.GameNumber}"><div class="game-tbl container-fluid mb-1">${GameTime(game.GameDateTime)}<div class="game-tbl row">${AwayTeam(game.Away,game.Lines)}
${HomeTeam(game.Home,game.Lines)}
${game.Draw!=null?Draw(game.Lines):''}</div></div></div>`)}
function LoadFollowed(){let url='/api/sportsbook/gamelines/listfollowed';let method='GET'
function OnSuccess(response){let{data}=response;if(data&&data.length>0){jQuery('.no-follows-container').remove();data.map((follow)=>RenderFollow(follow));}else{RenderEmptyFollows();}}
function OnError(jqXHR,textStatus,errorThrown){console.error("Error loading the followed games",{statusCode:jqXHR.status,serverMessage:jqXHR?.responseJSON?.Message})
RenderError("Error loading the followed games");}
ExecuteRequest(url,method,null,OnSuccess,OnError);}
function AddFollow(id,type,control){let $control=jQuery(control);let url='/api/sportsbook/favorites/add';let method='POST';let data={FavoriteType:type,Id:id}
function OnSuccess(){$control.attr("disabled",false);$control.addClass("following");$control.text("Following");}
$control.attr("disabled","disabled");ExecuteRequest(url,method,data,OnSuccess);}
function RemoveFollowing(id,type,control){let $control=jQuery(control);let url='/api/sportsbook/favorites/remove';let method='POST';let data={FavoriteType:type,Id:id}
function OnSuccess(){$control.attr("disabled",false);$control.removeClass("following");$control.text("Follow");let gameHtml=jQuery('#game-lines .normal[data-game="'+id+'"]');let parent=gameHtml.parents("#game-lines");gameHtml.remove();if(parent.find('.normal').length==0)
parent.remove();if(jQuery('#follows #game-lines').length==0)
RenderEmptyFollows();}
$control.attr("disabled","disabled");ExecuteRequest(url,method,data,OnSuccess);}
function AddBet(event,control,gameNumber,periodNumber,store,profile,lineType,chosenTeam,chosenTotal,price,decimal,numerator,denominator,points,quarter,opponentPrice){event.preventDefault();let $control=jQuery(control);let url='/api/sportsbook/gamelines/creategame';let method='POST';let data={gameNumber,periodNumber,store,profile,lineType,chosenTeam,chosenTotal,price,decimal,numerator,denominator,points,quarter,opponentPrice}
function OnSuccess(response){$control.attr("disabled",false);let{success,IsDeny,Item,error,returnUrl}=response;if(IsDeny){let errorDescription=typeof error==='string'?error:error.Description;jQuery('#follows .alert').remove()
jQuery('#follows').prepend('<div class="alert alert-danger" role="alert">'+errorDescription+'</div>');return;}
$control.addClass('bet-active');window.location.href=returnUrl;}
$control.attr("disabled","disabled");ExecuteRequest(url,method,data,OnSuccess);}
function ExecuteRequest(url,method='GET',data=null,successCallback=null,errorCallback=null){jQuery.ajax({url:url,type:method,data:data,success:function(data,textStatus,jqXHR){if(successCallback)
successCallback(data)},error:function(jqXHR,textStatus,errorThrown){console.error("Error executing the request")
if(errorCallback)
errorCallback(jqXHR,textStatus,errorThrown);}})}
var modal=document.getElementById("followinModalTutorial");var backButton=document.querySelector(".back-btn");var nextButton=document.querySelector(".next-btn");var steps=document.querySelectorAll(".tutorial-step");var indicators=document.querySelectorAll(".indicator");var currentStep=0;if(steps!=null&&steps!=undefined&&steps.length>0){steps[0].style.display="block";steps[1].style.display="none";steps[2].style.display="none";}
function closeModal(){}
function updateIndicators(){indicators.forEach((indicator,index)=>{if(index===currentStep){indicator.classList.add("active");}else{indicator.classList.remove("active");}});}
function goToPreviousStep(){if(currentStep>0){steps[currentStep].style.display="none";currentStep--;steps[currentStep].style.display="block";updateIndicators();}}
function goToNextStep(){if(currentStep<steps.length-1){steps[currentStep].style.display="none";currentStep++;steps[currentStep].style.display="block";updateIndicators();}else{nextButton.classList.add("close");nextButton.setAttribute("data-dismiss","modal");}}
function doneBtn(){if(currentStep===steps.length-1){nextButton.classList.add("btn-done");}else{nextButton.classList.remove("btn-done");nextButton.classList.remove("close");nextButton.removeAttribute("data-dismiss","modal");}}
if(backButton){backButton.addEventListener("click",goToPreviousStep);}
if(nextButton){nextButton.addEventListener("click",goToNextStep);}
if(nextButton){nextButton.addEventListener("click",doneBtn);}
if(backButton){backButton.addEventListener("click",doneBtn);}