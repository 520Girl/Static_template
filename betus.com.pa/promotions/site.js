function toFormData(obj,form,namespace){let fd=form||new FormData();let formKey;for(let property in obj){if(obj.hasOwnProperty(property)&&obj[property]){if(namespace){formKey=namespace+'['+property+']';}else{formKey=property;}
if(obj[property]instanceof Date){fd.append(formKey,obj[property].toISOString());}
else if(typeof obj[property]==='object'&&!(obj[property]instanceof File)){toFormData(obj[property],fd,formKey);}else{fd.append(formKey,obj[property]);}}}
return fd;}
var installEvt,backgroundOverlay=document.querySelector('.show-overlay-background'),homepageScroll=document.getElementById('bodyMaster');window.addEventListener('beforeinstallprompt',evt=>{const pwaInstalled=localStorage.getItem('PWAInstalled')==='true';if(pwaInstalled===true){$.ajax({url:'/miscellaneous/api/Pwa/AppInstalled?Installed=false',method:'POST',global:false});window.localStorage.setItem('PWAInstalled',false);}
installEvt=evt;evt.preventDefault();});$(document).ready(function(){if(!isExistCookie("pwa")){window.setTimeout(()=>{if(installEvt!==undefined&&installEvt!==null&&isMobile()){showPwaNotification();}else{showNotificationRequestPermission();}},30000);}});function showPwaNotification(){var delayPWA=document.querySelector('.pwa-row'),delayPwaOverlay=document.querySelector('.show-overlay-background');delayPWA.style.display='block';delayPwaOverlay.style.display='block';if(homepageScroll.offsetWidth<=991){homepageScroll.style.overflow='hidden';}}
function closePrompt(){$('#pwaNotification').removeClass('d-block');$('#pwaNotification').addClass('d-none');}
function closePwaNotification(){setCookie("pwa","disable",14);closePrompt();homepageScroll.style.overflow='unset';backgroundOverlay.style.display='none';}
function installApp(){closePrompt();if(isMobile()){if(installEvt!==undefined&&installEvt!==null){installEvt.prompt();installEvt.userChoice.then(()=>{showNotificationRequestPermission();});}}else{showNotificationRequestPermission();}}
function showNotificationRequestPermission(){window.setTimeout(()=>{Notification.requestPermission().then(function(state){const notificationsAllowed=localStorage.getItem('NotificationsAllowed')==='true';if(state==='granted'&&notificationsAllowed!==true){window.localStorage.setItem('NotificationsAllowed',true);$.ajax({url:'/miscellaneous/api/Pwa/AppInstalled?NotificationsAllowed=true',method:'POST',global:false});}
if(state==='denied'&&notificationsAllowed===true){window.localStorage.setItem('NotificationsAllowed',false);$.ajax({url:'/miscellaneous/api/Pwa/AppInstalled?NotificationsAllowed=false',method:'POST',global:false});}});},2000);}
window.addEventListener('appinstalled',evt=>{$.ajax({url:'/miscellaneous/api/Pwa/AppInstalled?Installed=true',method:'POST',global:false});window.localStorage.setItem('PWAInstalled',true);});